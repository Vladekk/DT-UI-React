(window["webpackJsonpdt-ui-react"]=window["webpackJsonpdt-ui-react"]||[]).push([[0],{22:function(e,t,n){e.exports={select:"TransportRouteSelector_select__1zNGG",outerDiv:"TransportRouteSelector_outerDiv__36YkC",item:"TransportRouteSelector_item__2ZBsH"}},33:function(e,t,n){e.exports={app:"App_app__18uvn"}},39:function(e,t,n){e.exports={to:"ScheduleOneDirection_to__2ht6A",highlight:"ScheduleOneDirection_highlight__37THO"}},42:function(e,t,n){e.exports=n(65)},47:function(e,t,n){},65:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),c=n(10),i=n.n(c),s=(n(47),n(6)),u=n(8),l=n(13),h=n(12),p=n(14),d=n(33),f=n.n(d),v=n(40),m=n(5),g=n.n(m),b=n(9),w=n(23),y=n(41),O=n(16);!function(e){e[e.ToUtc=-1]="ToUtc",e[e.FromUtc=1]="FromUtc"}(a||(a={}));var S,j,k,x,R=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"DateToUtcAndBack",value:function(e,t){return new Date(e.getTime()+60*e.getTimezoneOffset()*1e3*(t===a.ToUtc?1:-1))}},{key:"GetRigaTzOffsetInMs",value:function(){return 108e5}}]),e}(),C=Object(O.a)(S=function(){function e(t){Object(s.a)(this,e),this.configService=t,this.takeHowMuch=4}return Object(u.a)(e,[{key:"GetScheduleInfo",value:function(){var e=Object(b.a)(g.a.mark(function e(t){var n=this;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.configService.ScheduleServiceUrl+"GetClosestRuns",{headers:{"Content-Type":"application/json","Sec-Fetch-Site":"cross-site"},method:"post",body:JSON.stringify({BusNumber:t})}).then(function(){var e=Object(b.a)(g.a.mark(function e(t){var a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=n,e.next=3,t.json();case 3:return e.t1=e.sent,a=e.t0.fixDates.call(e.t0,e.t1),e.abrupt("return",a);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"GetAllRoutes",value:function(){var e=Object(b.a)(g.a.mark(function e(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.configService.ScheduleServiceUrl+"GetAllRoutes",{headers:{"Content-Type":"application/json","Sec-Fetch-Site":"cross-site"},method:"post",body:"{}"});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fixDates",value:function(t){var n=Object(y.a)(t,2),a=n[0],r=n[1];return[a.map(e.getProperDate).slice(0,this.takeHowMuch),r.map(e.getProperDate).slice(0,this.takeHowMuch)]}}],[{key:"getProperDate",value:function(e){var t=new Date(Date.parse(e));return new Date(t.getTime()-R.GetRigaTzOffsetInMs())}}]),e}())||S,E="https://upside.down.pictures/api/",D=function e(){Object(s.a)(this,e),this.ScheduleServiceUrl=E},T=o.a.createContext({loadingCounter:0,loading:function(e){}}),F=n(68),I=n(22),_=n.n(I),N=Object(O.b)((x=k=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).routesInCol=12,n.context=void 0,n.state={routes:[]},n.select=n.select.bind(Object(w.a)(n)),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(b.a)(g.a.mark(function e(){var t,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new C(new D),this.context.loading(!0),e.next=4,t.GetAllRoutes();case 4:n=e.sent,this.setState({routes:n}),this.select(this.props.selectedRoute),this.context.loading(!1);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=Math.round(this.state.routes.length/this.routesInCol);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:_.a.outerDiv},o.a.createElement(F.a,{id:"dropdown-basic-button",onSelect:function(t,n){n.preventDefault(),e.select(t)},className:_.a.select},o.a.createElement(F.a.Toggle,{id:"dropdown-basic",title:this.props.selectedRoute,variant:"warning",className:_.a.select},this.props.selectedRoute),o.a.createElement(F.a.Menu,null,Object(v.a)(Array(t).keys()).map(function(t){return o.a.createElement("div",{style:{float:"left"},key:"col"+t.toString()}," ",e.state.routes.slice(t*e.routesInCol,(t+1)*e.routesInCol).map(function(e){return o.a.createElement(F.a.Item,{className:_.a.item,eventKey:e.Number,key:e.Number,value:e.Number},e.Number)}))})))))}},{key:"select",value:function(e){this.props.onRouteChange(e)}}]),t}(o.a.Component),k.contextType=T,j=x))||j,M=n(39),U=n.n(M),A=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).context=void 0,n.state={routeInfos:[],now:new Date,intervalHandle:-1},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.state.intervalHandle)}},{key:"componentDidUpdate",value:function(){var e=Object(b.a)(g.a.mark(function e(t,n,a){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.selectedRoute===this.props.selectedRoute){e.next=3;break}return e.next=3,this.FetchScheduleForSelectedRoute(this.props.selectedRoute,this.props.isFromCentralStation);case 3:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(b.a)(g.a.mark(function e(){var t,n=this;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.FetchScheduleForSelectedRoute(this.props.selectedRoute,this.props.isFromCentralStation);case 2:t=window.setInterval(function(){return n.setState({now:new Date})},1e3),this.setState({intervalHandle:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"IsClosestToNow",value:function(e,t){var n=this,a=t.filter(function(e){return e>=n.state.now});return a.length>0&&a[0]===e}},{key:"formatRow",value:function(e){return"".concat(e.getHours().toString().padEnd(2,"0"),":").concat(e.getMinutes().toString().padEnd(2,"0"))}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement("h3",null,this.props.isFromCentralStation?"From center":"To center"),o.a.createElement("ul",null,this.state.routeInfos.map(function(t){return o.a.createElement("li",{key:t.toString(),className:e.IsClosestToNow(t,e.state.routeInfos)?U.a.highlight:""},e.formatRow(t))})))}},{key:"FetchScheduleForSelectedRoute",value:function(){var e=Object(b.a)(g.a.mark(function e(t,n){var a,r,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new C(new D),this.context.loading(!0),e.next=4,a.GetScheduleInfo(t);case 4:r=e.sent,o=n?r[0]:r[1],this.setState({routeInfos:o}),this.context.loading(!1);case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),t}(o.a.Component);A.contextType=T;n(64);var G,H=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).style={color:"red"},n.el=void 0,n.context=void 0,n.el=document.createElement("div"),document.children[0].appendChild(n.el),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.6)",display:0!==this.context.loadingCounter?"block":"none"}},o.a.createElement("div",{style:{color:"orange",marginLeft:"auto",marginRight:"auto",width:"15vh",height:"15vh",top:"35vh"},className:"la-cog"},o.a.createElement("div",null)))}}]),t}(o.a.Component);H.defaultProps={},H.contextType=T;var B=Object(O.b)(G=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).loading=function(e){return n.setState(function(t){return{isLoading:t.isLoading+(e?1:-1)}})},n.state={selectedRoute:"17A",isLoading:1},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.setState({selectedRoute:"17A"}),this.loading(!1)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:f.a.app},o.a.createElement(T.Provider,{value:{loadingCounter:this.state.isLoading,loading:this.loading}},o.a.createElement(H,null),o.a.createElement("header",{className:"App-header"},o.a.createElement(N,{selectedRoute:this.state.selectedRoute,onRouteChange:function(t){return e.setState({selectedRoute:t})}}),o.a.createElement(A,{isFromCentralStation:!0,selectedRoute:this.state.selectedRoute}),o.a.createElement(A,{isFromCentralStation:!1,selectedRoute:this.state.selectedRoute}))))}}]),t}(o.a.Component))||G;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[42,1,2]]]);
//# sourceMappingURL=main.075951f2.chunk.js.map